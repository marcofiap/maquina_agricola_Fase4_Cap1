-- Generated by Oracle SQL Developer Data Modeler 24.3.1.351.0831
--   at:        2025-04-18 13:44:36 BRT
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



DROP TABLE agua_aplicada CASCADE CONSTRAINTS 
;

DROP TABLE calibracao_sensor CASCADE CONSTRAINTS 
;

DROP TABLE cultura CASCADE CONSTRAINTS 
;

DROP TABLE monitoramento CASCADE CONSTRAINTS 
;

DROP TABLE sensor CASCADE CONSTRAINTS 
;

DROP TABLE sensor_tipo_sensor CASCADE CONSTRAINTS 
;

DROP TABLE tipo_sensor CASCADE CONSTRAINTS 
;

DROP TABLE unidade_medida CASCADE CONSTRAINTS 
;

DROP TABLE vitaminas CASCADE CONSTRAINTS 
;

DROP TABLE vitaminas_aplicadas CASCADE CONSTRAINTS 
;

-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE agua_aplicada 
    ( 
     id_agua_aplicada           NUMBER (10)  NOT NULL , 
     id_cultura                 NUMBER (5) , 
     id_sensor                  NUMBER (6) , 
     volume_agua_aplicada       NUMBER (7,4)  NOT NULL , 
     data_hora_inicio_aplicacao TIMESTAMP  NOT NULL , 
     data_hora_fim_aplicacao    TIMESTAMP  NOT NULL , 
     agua_aplicada_manualmente  CHAR (1) , 
     responsavel                VARCHAR2 (50) , 
     observacao                 CLOB 
    ) 
;

COMMENT ON COLUMN agua_aplicada.id_cultura IS 'Sensor: id_cultura = sensor | Manualmente: agua_aplicada_manualmente = true e Exigir preenchimento de id_cultura' 
;

COMMENT ON COLUMN agua_aplicada.agua_aplicada_manualmente IS 'Verdadeiro para se agua aplicada manualmente sem utilizar sensores - Valor padrao = false' 
;

ALTER TABLE agua_aplicada 
    ADD CONSTRAINT CK_agua_aplicada_id_cultura 
    CHECK (agua_aplicada_manualmente = true OR id_sensor is not null)
;


ALTER TABLE agua_aplicada 
    ADD CONSTRAINT CK_agua_aplicada_data_ini 
    CHECK (data_hora_inicio_aplicacao < data_hora_fim_aplicacao)
;


ALTER TABLE agua_aplicada 
    ADD CONSTRAINT CK_agua_aplicada_data_fim 
    CHECK (data_hora_fim_aplicacao > data_hora_inicio_aplicacao)
;
ALTER TABLE agua_aplicada 
    ADD CONSTRAINT PK_agua_aplicada PRIMARY KEY ( id_agua_aplicada ) ;

CREATE TABLE calibracao_sensor 
    ( 
     id_sensor        NUMBER (6)  NOT NULL , 
     data_calibracao  TIMESTAMP  NOT NULL , 
     fator_calibracao NUMBER (6,3) , 
     responsavel      VARCHAR2 (50) 
    ) 
;

ALTER TABLE calibracao_sensor 
    ADD CONSTRAINT PK_calibracao_sensor PRIMARY KEY ( data_calibracao, id_sensor ) ;

CREATE TABLE cultura 
    ( 
     id_cultura        NUMBER (5)  NOT NULL , 
     descricao_cultura VARCHAR2 (30)  NOT NULL , 
     ativo             CHAR (1)  NOT NULL , 
     area_plantada     NUMBER (10,2) 
    ) 
;

ALTER TABLE cultura 
    ADD CONSTRAINT PK_cultura PRIMARY KEY ( id_cultura ) ;

CREATE TABLE monitoramento 
    ( 
     id_monitoramento        NUMBER (20)  NOT NULL , 
     id_sensor               NUMBER (6)  NOT NULL , 
     valor                   NUMBER (7,2)  NOT NULL , 
     data_hora_monitoramento TIMESTAMP  NOT NULL 
    ) 
;

ALTER TABLE monitoramento 
    ADD CONSTRAINT PK_monitoramento PRIMARY KEY ( id_monitoramento ) ;

CREATE TABLE sensor 
    ( 
     id_sensor    NUMBER (6)  NOT NULL , 
     id_cultura   NUMBER (5)  NOT NULL , 
     numero_serie VARCHAR2 (30)  NOT NULL , 
     ativo        CHAR (1)  NOT NULL 
    ) 
;

ALTER TABLE sensor 
    ADD CONSTRAINT PK_sensor PRIMARY KEY ( id_sensor ) ;

ALTER TABLE sensor 
    ADD CONSTRAINT UN_sensor_num_serie UNIQUE ( numero_serie ) ;

CREATE TABLE sensor_tipo_sensor 
    ( 
     id_tipo_sensor NUMBER (3)  NOT NULL , 
     id_sensor      NUMBER (6)  NOT NULL 
    ) 
;

ALTER TABLE sensor_tipo_sensor 
    ADD CONSTRAINT PK_sensor_tipo_sensor PRIMARY KEY ( id_sensor, id_tipo_sensor ) ;

CREATE TABLE tipo_sensor 
    ( 
     id_tipo_sensor    NUMBER (3)  NOT NULL , 
     id_unidade_medida NUMBER (3)  NOT NULL , 
     descricao         VARCHAR2 (30)  NOT NULL 
    ) 
;

ALTER TABLE tipo_sensor 
    ADD CONSTRAINT PK_tipo_sensor PRIMARY KEY ( id_tipo_sensor ) ;

ALTER TABLE tipo_sensor 
    ADD CONSTRAINT UN_tipo_sensor_descricao UNIQUE ( descricao ) ;

CREATE TABLE unidade_medida 
    ( 
     id_unidade_medida NUMBER (3)  NOT NULL , 
     descricao         VARCHAR2 (35)  NOT NULL , 
     abreviacao        VARCHAR2 (5)  NOT NULL 
    ) 
;

ALTER TABLE unidade_medida 
    ADD CONSTRAINT PK_unidade_medida PRIMARY KEY ( id_unidade_medida ) ;

ALTER TABLE unidade_medida 
    ADD CONSTRAINT UN_unid_med_desc_abrev UNIQUE ( descricao , abreviacao ) ;

CREATE TABLE vitaminas 
    ( 
     id_vitamina       NUMBER (6)  NOT NULL , 
     id_unidade_medida NUMBER (3)  NOT NULL , 
     nome              VARCHAR2 (30)  NOT NULL , 
     ativo             CHAR (1)  NOT NULL , 
     descricao         VARCHAR2 (150) 
    ) 
;

ALTER TABLE vitaminas 
    ADD CONSTRAINT PK_vitaminas PRIMARY KEY ( id_vitamina ) ;

ALTER TABLE vitaminas 
    ADD CONSTRAINT UN_vitaminas_nome UNIQUE ( nome ) ;

CREATE TABLE vitaminas_aplicadas 
    ( 
     id_vitamina_aplicada NUMBER (10)  NOT NULL , 
     id_vitamina          NUMBER (6)  NOT NULL , 
     id_cultura           NUMBER (5)  NOT NULL , 
     data_aplicacao       TIMESTAMP  NOT NULL , 
     quantidade           NUMBER (10,2)  NOT NULL , 
     responsavel          VARCHAR2 (50) , 
     observacao           CLOB 
    ) 
;

ALTER TABLE vitaminas_aplicadas 
    ADD CONSTRAINT PK_vitaminas_aplicadas PRIMARY KEY ( id_vitamina_aplicada ) ;

ALTER TABLE agua_aplicada 
    ADD CONSTRAINT FK_agua_aplicada_cultura FOREIGN KEY 
    ( 
     id_cultura
    ) 
    REFERENCES cultura 
    ( 
     id_cultura
    ) 
;

ALTER TABLE agua_aplicada 
    ADD CONSTRAINT FK_agua_aplicada_sensor FOREIGN KEY 
    ( 
     id_sensor
    ) 
    REFERENCES sensor 
    ( 
     id_sensor
    ) 
;

ALTER TABLE calibracao_sensor 
    ADD CONSTRAINT FK_calib_sen_sens FOREIGN KEY 
    ( 
     id_sensor
    ) 
    REFERENCES sensor 
    ( 
     id_sensor
    ) 
;

ALTER TABLE monitoramento 
    ADD CONSTRAINT FK_monit_sen FOREIGN KEY 
    ( 
     id_sensor
    ) 
    REFERENCES sensor 
    ( 
     id_sensor
    ) 
;

ALTER TABLE sensor 
    ADD CONSTRAINT FK_sen_cul FOREIGN KEY 
    ( 
     id_cultura
    ) 
    REFERENCES cultura 
    ( 
     id_cultura
    ) 
;

ALTER TABLE sensor_tipo_sensor 
    ADD CONSTRAINT FK_sen_tp_sen_sen FOREIGN KEY 
    ( 
     id_sensor
    ) 
    REFERENCES sensor 
    ( 
     id_sensor
    ) 
;

ALTER TABLE sensor_tipo_sensor 
    ADD CONSTRAINT FK_sen_tp_sen_tp_sen FOREIGN KEY 
    ( 
     id_tipo_sensor
    ) 
    REFERENCES tipo_sensor 
    ( 
     id_tipo_sensor
    ) 
;

ALTER TABLE tipo_sensor 
    ADD CONSTRAINT FK_tp_sen_unid_med FOREIGN KEY 
    ( 
     id_unidade_medida
    ) 
    REFERENCES unidade_medida 
    ( 
     id_unidade_medida
    ) 
;

ALTER TABLE vitaminas_aplicadas 
    ADD CONSTRAINT FK_vitam_aplic_cult FOREIGN KEY 
    ( 
     id_cultura
    ) 
    REFERENCES cultura 
    ( 
     id_cultura
    ) 
;

ALTER TABLE vitaminas_aplicadas 
    ADD CONSTRAINT FK_vitam_aplic_vitam FOREIGN KEY 
    ( 
     id_vitamina
    ) 
    REFERENCES vitaminas 
    ( 
     id_vitamina
    ) 
;

ALTER TABLE vitaminas 
    ADD CONSTRAINT FK_vitam_unid_med FOREIGN KEY 
    ( 
     id_unidade_medida
    ) 
    REFERENCES unidade_medida 
    ( 
     id_unidade_medida
    ) 
;



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            10
-- CREATE INDEX                             0
-- ALTER TABLE                             28
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
